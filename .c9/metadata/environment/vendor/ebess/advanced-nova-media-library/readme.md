{"changed":true,"filter":false,"title":"readme.md","tooltip":"/vendor/ebess/advanced-nova-media-library/readme.md","value":"f# Laravel Advanced Nova Media Library\n\nManage images of [spatie's media library package](https://github.com/spatie/laravel-medialibrary). Upload multiple\nimages and order them by drag and drop.\n\n##### Table of Contents  \n* [Examples](#examples)  \n* [Install](#install)  \n* [Model media configuration](#model-media-configuration)  \n* [Generic file management](#generic-file-management)  \n* [Single image upload](#single-image-upload)  \n* [Multiple image upload](#multiple-image-upload)  \n* [Selecting existing media](#selecting-existing-media)  \n* [Names of uploaded images](#names-of-uploaded-images)  \n* [Image cropping](#image-cropping)\n* [Custom properties](#custom-properties)\n* [Custom headers](#custom-headers)\n* [Media Field (Video)](#media-field-video)  \n* [Change log](#change-log)  \n\n## Examples\n![Cropping](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/cropping.gif)\n![Single image upload](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/single-image.png)\n![Multiple image upload](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/multiple-images.png)\n![Custom properties](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/custom-properties.gif)\n![Generic file management](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/file-management.png)\n\n## Install\n```bash\ncomposer require ebess/advanced-nova-media-library\n```\n\n```bash\nphp artisan vendor:publish --tag=nova-media-library\n```\n\n## Model media configuration\n\nLet's assume you configured your model to use the media library like following:\n```php\nuse Spatie\\MediaLibrary\\MediaCollections\\Models\\Media;\n\npublic function registerMediaConversions(Media $media = null): void\n{\n    $this->addMediaConversion('thumb')\n        ->width(130)\n        ->height(130);\n}\n\npublic function registerMediaCollections(): void\n{\n    $this->addMediaCollection('main')->singleFile();\n    $this->addMediaCollection('my_multi_collection');\n}\n```\n\n## Generic file management\n\n![Generic file management](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/file-management.png)\n\nIn order to be able to upload and handle generic files just go ahead and use the `Files` field.\n\n```php\nuse Ebess\\AdvancedNovaMediaLibrary\\Fields\\Files;\n\nFiles::make('Single file', 'one_file'),\nFiles::make('Multiple files', 'multiple_files'),\n```\n\n## Single image upload\n\n![Single image upload](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/single-image.png)\n\n```php\nuse Ebess\\AdvancedNovaMediaLibrary\\Fields\\Images;\n\npublic function fields(Request $request)\n{\n    return [\n        Images::make('Main image', 'main') // second parameter is the media collection name\n            ->conversionOnIndexView('thumb') // conversion used to display the image\n            ->rules('required'), // validation rules\n    ];\n}\n```\n\n## Multiple image upload\n\nIf you enable the multiple upload ability, you can **order the images via drag & drop**.\n\n![Multiple image upload](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/multiple-images.png)\n\n```php\nuse Ebess\\AdvancedNovaMediaLibrary\\Fields\\Images;\n\npublic function fields(Request $request)\n{\n    return [\n        Images::make('Images', 'my_multi_collection') // second parameter is the media collection name\n            ->conversionOnPreview('medium-size') // conversion used to display the \"original\" image\n            ->conversionOnDetailView('thumb') // conversion used on the model's view\n            ->conversionOnIndexView('thumb') // conversion used to display the image on the model's index page\n            ->conversionOnForm('thumb') // conversion used to display the image on the model's form\n            ->fullSize() // full size column\n            ->rules('required', 'size:3') // validation rules for the collection of images\n            // validation rules for the collection of images\n            ->singleImageRules('dimensions:min_width=100'),\n    ];\n}\n```\n\n## Selecting existing media\n\n![Selecting existing media](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/existing-media.png)\n![Selecting existing media 2](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/existing-media-2.png)\n\nIf you upload the same media files to multiple models and you do not want to select it from the file system\nall over again, use this feature. Selecting an already existing media will **copy it**.\n\n**Attention**: This feature will expose an endpoint to every user of your application to search existing media. \nIf your media upload / custom properties on the media models are confidential, **do not enable this feature!** \n\n* Publish the config files if you did not yet\n```bash\nartisan vendor:publish --tag=nova-media-library\n```\n* Enable this feature in config file *config/nova-media-library*\n```php\nreturn [\n    'enable-existing-media' => true,\n];\n```\n* Enable the selection of existing media field\n```php\nImages::make('Image')->enableExistingMedia(),\n```\n\n**Note**: This feature does not support temporary URLs.\n\n## Names of uploaded images\n\nThe default filename of the new uploaded file is the original filename. You can change this with the help of the function `setFileName`, which takes a callback function as the only param. This callback function has three params: `$originalFilename` (the original filename like `Fotolia 4711.jpg`), `$extension` (file extension like `jpg`), `$model` (the current model). Here are just 2 examples of what you can do:\n\n```php\n// Set the filename to the MD5 Hash of original filename\nImages::make('Image 1', 'img1')\n    ->setFileName(function($originalFilename, $extension, $model){\n        return md5($originalFilename) . '.' . $extension;\n    });\n\n// Set the filename to the model name\nImages::make('Image 2', 'img2')\n    ->setFileName(function($originalFilename, $extension, $model){\n        return str_slug($model->name) . '.' . $extension;\n    });\n```\n\nBy default, the \"name\" field on the Media object is set to the original filename without the extension. To change this, you can use the `setName` function. Like `setFileName` above, it takes a callback function as the only param. This callback function has two params: `$originalFilename` and `$model`.\n\n```php\nImages::make('Image 1', 'img1')\n    ->setName(function($originalFilename, $model){\n        return md5($originalFilename);\n    });\n```\n\n## Responsive images\n\nIf you want to use responsive image functionality from the [Spatie MediaLibrary](https://docs.spatie.be/laravel-medialibrary/v7/responsive-images/getting-started-with-responsive-images), you can use the `withResponsiveImages()` function on the model.\n\n```php\nImages::make('Image 1', 'img1')\n    ->withResponsiveImages();\n\n```\n\n## Image cropping\n\n![Cropping](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/cropping.gif)\n\nBy default you are able to crop / rotate images by clicking the scissors in the left bottom corner on the edit view. \nThe [vue-js-clipper](https://github.com/timtnleeProject/vuejs-clipper) is used for this purpose. The cropping feature is \nlimited to mime type of `image/jpg`, `image/jpeg` and `image/png`.\n\n**Important:** By cropping an existing image the original media model is deleted and replaced by the cropped image. \nAll custom properties are copied form the old to the new model.\n\nTo disable this feature use the `croppable` method:\n```php\nImages::make('Gallery')->croppable(false);\n```\n\nYou can set all configurations like ratio e.g. as following: \n```php\nImages::make('Gallery')->croppingConfigs(['aspectRatio' => 4/3]);\n```\nAvailable cropping configuration, see https://github.com/timtnleeProject/vuejs-clipper#clipper-basic.\n\nIt is possible to enforce cropping on upload, for example to ensure the image has the set aspect ratio:\n```php\nImages::make('Gallery')->mustCrop();\n```\n\n### Disabling cropping by default\n\nBy default, the cropping feature is enabled. To disable it by default for all images set `default-croppable` in `config/nova-media-library.php` to `false`:\n```php\nreturn [\n    'default-croppable' => false,\n];\n```\n\n## Custom properties\n\n![Custom properties](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/custom-properties.gif)\n\n```php\nImages::make('Gallery')\n    ->customPropertiesFields([\n        Boolean::make('Active'),\n        Markdown::make('Description'),\n    ]);\n    \nFiles::make('Multiple files', 'multiple_files')\n    ->customPropertiesFields([\n        Boolean::make('Active'),\n        Markdown::make('Description'),\n    ]);\n    \n// custom properties without user input\nFiles::make('Multiple files', 'multiple_files')\n    ->customProperties([\n        'foo' => auth()->user()->foo,\n        'bar' => $api->getNeededData(),\n    ]);\n```\n\n## Show image statistics *(size, dimensions, type)*\n\n![Image statistics](https://raw.githubusercontent.com/ebess/advanced-nova-media-library/master/docs/show-statistics.png)\n\n```php\nImages::make('Gallery')\n    ->showStatistics();\n```\n\n## Custom headers\n\n```php\nImages::make('Gallery')\n    ->customHeaders([\n        'header-name' => 'header-value', \n    ]);\n```\n\n## Media Field (Video)\n\nIn order to handle videos with thumbnails you need to use the `Media` field instead of `Images`. This way you are able to upload videos as well.\n\n```php\nuse Ebess\\AdvancedNovaMediaLibrary\\Fields\\Media;\n\nclass Category extends Resource\n{\n    public function fields(Request $request)\n    {\n        Media::make('Gallery') // media handles videos\n            ->conversionOnIndexView('thumb')\n            ->singleMediaRules('max:5000'); // max 5000kb\n    }\n}\n\n// ..\n\nclass YourModel extends Model implements HasMedia\n{\n    public function registerMediaConversions(Media $media = null): void\n    {\n        $this->addMediaConversion('thumb')\n            ->width(368)\n            ->height(232)\n            ->extractVideoFrameAtSecond(1);\n    }\n}\n```\n\n## Temporary Urls\n\nIf you are using Amazon S3 to store your media, you will need to use the `temporary` function on your field to generate\na temporary signed URL. This function expects a valid Carbon instance that will specify when the URL should expire.\n\n```\nImages::make('Image 1', 'img1')\n    ->temporary(now()->addMinutes(5))\n\nFiles::make('Multiple files', 'multiple_files')\n    ->temporary(now()->addMinutes(10),\n```\n\n**Note**: This feature does not work with the existing media feature. \n\n# Credits\n\n* [nova media library](https://github.com/jameslkingsley/nova-media-library)\n\n# Alternatives\n\n* [dmitrybubyakin/nova-medialibrary-field](https://github.com/dmitrybubyakin/nova-medialibrary-field)\n\n# Change log\n\n## v4.0.2 - 2022-04-26\n- Fix ratio for cropping in Nova 4. Config from `Images::( ... )->croppingConfigs()` are now passed along to the `stencil-props` property of the cropper. See [cropper docs](https://norserium.github.io/vue-advanced-cropper/components/rectangle-stencil.html#props) for more details on available props.\n\n## v4.0.1 - 2022-04-20\n- Fix details component\n- Fix layout inconsistencies \n\n## v4.0.0 - 2022-04-18\n- Upgrade to support Laravel Nova 4\n- Breaks compatibility with Laravel Nova 1,2 and 3. For those nova versions  use `v3.*`\n- Replaced [vuejs-clipper](https://www.npmjs.com/package/vuejs-clipper) with [vue-advanced-cropper](https://www.npmjs.com/package/vue-advanced-cropper) for vue3 support\n\nFull change log in [PR #317](https://github.com/ebess/advanced-nova-media-library/pull/317)\n\n# How to contribute\n\n- You need to have Nova installed of course in your Laravel app\n- Work directly in the package in the `vendor` directory (webpack needs Nova to be installed)\n- Then from the `vendor/xxx/advanced-nova-media-library` folder:\n    - `yarn install` \n    - `yarn npm watch` \n    - Work hard ðŸ¤˜\n    - `yarn npm production` when job is finished\n    - Make a PR\n","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["f"],"id":2}]]},"ace":{"folds":[],"scrolltop":3791.0999999999945,"scrollleft":11.999999999999996,"selection":{"start":{"row":250,"column":4},"end":{"row":252,"column":7},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":235,"state":"start","mode":"ace/mode/markdown"}},"timestamp":1689204330917}